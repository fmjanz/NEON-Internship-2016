evennessC[i] <- Cdiv[i]/log(abundance)
}
MGdiv <- (rep(0,END))
evennessM <- (rep(0,END))
abundanceC <- (rep(0,END2))
for (i in 1:(END)){
MGdiv[i] <- diversity(as.numeric(MGdata_flip[i,]))
abundanceM[i] <- specnumber(MGdata_flip[i,])
evennessM[i] <-  MGdiv[i]/log(abundance)
}
Cdiv <- (rep(0,END2))
evennessC <- (rep(0,END2))
abundanceC <- (rep(0,END2))
for (i in 1:(END2)){
Cdiv[i] <- diversity(as.numeric(Cdata_flip[i,]))
abundanceC[i] <- specnumber(Cdata_flip[i,])
evennessC[i] <- Cdiv[i]/log(abundance)
}
MGdiv <- (rep(0,END))
evennessM <- (rep(0,END))
abundanceM <- (rep(0,END2))
for (i in 1:(END)){
MGdiv[i] <- diversity(as.numeric(MGdata_flip[i,]))
abundanceM[i] <- specnumber(MGdata_flip[i,])
evennessM[i] <-  MGdiv[i]/log(abundance)
}
abundanceM
abundanceC
Cdiv <- (rep(0,END2))
evennessC <- (rep(0,END2))
for (i in 1:(END2)){
Cdiv[i] <- diversity(as.numeric(Cdata_flip[i,]))
abundance <- specnumber(Cdata_flip[i,])
evennessC[i] <- Cdiv[i]/log(abundance)
}
MGdiv <- (rep(0,END))
evennessM <- (rep(0,END))
for (i in 1:(END)){
MGdiv[i] <- diversity(as.numeric(MGdata_flip[i,]))
abundance <- specnumber(MGdata_flip[i,])
evennessM[i] <-  MGdiv[i]/log(abundance)
}
Cdiv <- as.data.frame(Cdiv)
MGdiv <- as.data.frame(MGdiv)
evennessC <- as.data.frame(evennessC)
evennessM <- as.data.frame(evennessM)
View(Cdiv)
rm(list=ls())
t.otu <- function(x, s, e) {
## Written by Lee Stanish
## transpose OTU table for ordination analysis##
## x=OTU table; s=starting column; e=ending column
x <- as.data.frame(x)
x1 <- t(x[,c(s:e)])      # transpose OTU counts
colnames(x1) <- x[,1]     #replace OTU ids as column names
x1
}
fill.taxonomy.newMG <- function(x) {
### Parses taxon names in abundance table. Specific for 'new' MG-RAST output
### tables with structure "metagenomeID.DB.taxonlevel.csv"
### Table should be read in as tab-separated .csv file.
### By Lee Stanish June 27, 2016
#tax <- x[,1]
tax <- x
alltax <- str_split_fixed(as.character(tax), pattern=";",n=7)
colnames(alltax) <- c("domain", "phylum", "class", "order", "family","genus", "species")
alltax <- data.frame(alltax)
return(alltax)
}
### End required function ##
######    Start of code    ######
setwd("C:/Users/fjanz/Documents/GitHub/NEON-Internship-2016")
otu <- read.csv("Functional_beta_div_data.csv",header=TRUE)
env <- read.csv("Functional_beta_div_metadata.csv", header= TRUE)
otu.t <- t.otu(x=otu,s=2,e=length(otu))  # adjust numbers as needed for your OTU table
ncol(otu.t)
###########           Analysis code (for later)       ####################
###Rarefy OTU table###
### A) Calculate total # seqs for each sample
tototu <- apply(otu.t, MARGIN=1, FUN=sum)
min(tototu)			# rarefy to this value
### B) Rarefy
oturare <- rrarefy(otu.t, min(tototu))
### C) Generate rarefaction curves (test)
rarecurve(otu.t, step=100000,sample=min(tototu))
### D) Remove OTUs with 0 or 1 abundance
#otumax <- apply(oturare, 2, max)
#otu.1 <- oturare[, otumax >= 2]
#taxonomy.1 <- droplevels(taxonomy[otumax >= 2,])
#Transform rarefied OTU table
otu.pct <- decostand(otu.1, method="total")
otu.hell <- decostand(otu.1, method="hellinger")  # Hellinger transformation
######## nMDS  #####
mds <- metaMDS(otu.pct, k=2, distance="bray", trymax=20, autotransform=FALSE)
# Shepard plot to compare actual dissimilarities to computed dissimilarities
diss <- vegdist(otu.pct, distance="bray")
stressplot(mds, diss) ## pretty nice fit
mds.sc <- scores(mds, display="sites", choices=c(1:2))
mds.spec <- scores(mds, display="species", choices=c(1:2))
########     Plot results (not generified)    ########
###All samples#
plot(mds, type="p", choices=c(1,2), cex.lab=1.5,cex.axis=1.5,font=1.5,font.axis=2,font.lab=1.5)
mds.sc <- data.frame(mds.sc)
functionMax <- apply(otu.1,2,max)
hist(functionMax, breaks=24)
mdsfn5000 <- mds$species[functionMax>20000,]   ##nMDS functional coordinates for OTUs
mdsfn5000IDs <- rownames(mdsfn5000)
mds.sc <- data.frame(mds.sc)
otu.pct <- decostand(otu.1, method="total")
otumax <- apply(oturare, 2, max)
otu.1 <- oturare[, otumax >= 2]
otu.pct <- decostand(otu.1, method="total")
otu.hell <- decostand(otu.1, method="hellinger")
mds <- metaMDS(otu.pct, k=2, distance="bray", trymax=20, autotransform=FALSE)
# Shepard plot to compare actual dissimilarities to computed dissimilarities
diss <- vegdist(otu.pct, distance="bray")
stressplot(mds, diss) ## pretty nice fit
mds.sc <- scores(mds, display="sites", choices=c(1:2))
mds.spec <- scores(mds, display="species", choices=c(1:2))
mds.sc <- data.frame(mds.sc)
functionMax <- apply(otu.1,2,max)
hist(functionMax, breaks=24)
mdsfn5000 <- mds$species[functionMax>20000,]   ##nMDS functional coordinates for OTUs
mdsfn5000IDs <- rownames(mdsfn5000)
points(mdsfn5000[,1], mdsfn5000[,2], display="sites", col="black", pch=19)
text(mdsfn5000[,1], mdsfn5000[,2], display="sites", col="black", labels=mdsfn5000IDs, cex=0.5)
ordihull(mds, env$siteID, lty=2)
legend("topright",pch=c(seq(1,6)), col="black", c("CPER","DSNY","HARV","OSBS","STER","TALL"),
bty="o",box.col="black", cex=.8)
legend("bottomright",pch=c(15,15),col=c("darkblue","orangered4"), c("Individual","Composite"),
bty="o",box.col = "black")
plot(mds, type="none", choices=c(1,2), cex.lab=1.5,cex.axis=1.5,font=1.5,font.axis=2,
font.lab=1.5, xlim=c(-0.09,0.12),ylim=c(-0.09,0.09),xlab= "NMDS Axis 1", ylab="NMDS Axis 2",
main = "Comparison of Sample Types Across Sites", frame.plot=FALSE)
points(mds.sc[,1], mds.sc[,2],display="sites", col=ifelse(env$sampleType=="Individual","darkblue","orangered4"),
pch = as.integer(env$siteID))
points(mds.sc[,1], mds.sc[,2],display="sites", col=ifelse(env$sampleType=="Individual","darkblue","orangered4"),
pch = seq(10,15))
plot(mds, type="none", choices=c(1,2), cex.lab=1.5,cex.axis=1.5,font=1.5,font.axis=2,
font.lab=1.5, xlim=c(-0.09,0.12),ylim=c(-0.09,0.09),xlab= "NMDS Axis 1", ylab="NMDS Axis 2",
main = "Comparison of Sample Types Across Sites", frame.plot=FALSE)
points(mds.sc[,1], mds.sc[,2],display="sites", col=ifelse(env$sampleType=="Individual","darkblue","orangered4"),
pch = seq(10,15))
legend("topright",pch=c(seq(1,6)), col="black", c("CPER","DSNY","HARV","OSBS","STER","TALL"),
bty="o",box.col="black", cex=.8)
plot(mds, type="none", choices=c(1,2), cex.lab=1.5,cex.axis=1.5,font=1.5,font.axis=2,
font.lab=1.5, xlim=c(-0.09,0.12),ylim=c(-0.09,0.09),xlab= "NMDS Axis 1", ylab="NMDS Axis 2",
main = "Comparison of Sample Types Across Sites", frame.plot=FALSE)
points(mds.sc[,1], mds.sc[,2],display="sites", col=ifelse(env$sampleType=="Individual","darkblue","orangered4"),
pch = 10:15)
plot(mds, type="none", choices=c(1,2), cex.lab=1.5,cex.axis=1.5,font=1.5,font.axis=2,
font.lab=1.5, xlim=c(-0.09,0.12),ylim=c(-0.09,0.09),xlab= "NMDS Axis 1", ylab="NMDS Axis 2",
main = "Comparison of Sample Types Across Sites", frame.plot=FALSE)
points(mds.sc[,1], mds.sc[,2],display="sites", col=ifelse(env$sampleType=="Individual","darkblue","orangered4"),
pch = (as.integer(env$siteID) + 10))
plot(mds, type="none", choices=c(1,2), cex.lab=1.5,cex.axis=1.5,font=1.5,font.axis=2,
font.lab=1.5, xlim=c(-0.09,0.12),ylim=c(-0.09,0.09),xlab= "NMDS Axis 1", ylab="NMDS Axis 2",
main = "Comparison of Sample Types Across Sites", frame.plot=FALSE)
points(mds.sc[,1], mds.sc[,2],display="sites", col=ifelse(env$sampleType=="Individual","darkblue","orangered4"),
pch = (as.integer(env$siteID) + 19))
plot(mds, type="none", choices=c(1,2), cex.lab=1.5,cex.axis=1.5,font=1.5,font.axis=2,
font.lab=1.5, xlim=c(-0.09,0.12),ylim=c(-0.09,0.09),xlab= "NMDS Axis 1", ylab="NMDS Axis 2",
main = "Comparison of Sample Types Across Sites", frame.plot=FALSE)
points(mds.sc[,1], mds.sc[,2],display="sites", col=ifelse(env$sampleType=="Individual","darkblue","orangered4"),
pch = (as.integer(env$siteID) + 19), bg=ifelse(env$sampleType=="Individual","darkblue","orangered4"))
plot(mds, type="none", choices=c(1,2), cex.lab=1.5,cex.axis=1.5,font=1.5,font.axis=2,
font.lab=1.5, xlim=c(-0.09,0.12),ylim=c(-0.09,0.09),xlab= "NMDS Axis 1", ylab="NMDS Axis 2",
main = "Comparison of Sample Types Across Sites", frame.plot=FALSE)
points(mds.sc[,1], mds.sc[,2],display="sites", col=ifelse(env$sampleType=="Individual","dodgerblue4","lightsteelblue4"),
pch = (as.integer(env$siteID) + 19), bg=ifelse(env$sampleType=="Individual","darkblue","orangered4"))
ordihull(mds, env$siteID, lty=2)
legend("topright",pch=c(seq(19,25)), col="black", c("CPER","DSNY","HARV","OSBS","STER","TALL"),
bty="o",box.col="black", cex=.8)
legend("bottomright",pch=c(15,15),col=c("dodgerblue4","lightsteelblue4"), c("Individual","Composite"),
bty="o",box.col = "black")
plot(mds, type="none", choices=c(1,2), cex.lab=1.5,cex.axis=1.5,font=1.5,font.axis=2,
font.lab=1.5, xlim=c(-0.09,0.12),ylim=c(-0.09,0.09),xlab= "NMDS Axis 1", ylab="NMDS Axis 2",
main = "Comparison of Sample Types Across Sites", frame.plot=FALSE)
points(mds.sc[,1], mds.sc[,2],display="sites", col=ifelse(env$sampleType=="Individual","dodgerblue4","lightsteelblue2"),
pch = (as.integer(env$siteID) + 19), bg=ifelse(env$sampleType=="Individual","dodgerblue4","lightsteelblue2"))
ordihull(mds, env$siteID, lty=2)
legend("topright",pch=c(seq(19,25)), col="black", c("CPER","DSNY","HARV","OSBS","STER","TALL"),
bty="o",box.col="black", cex=.8)
legend("bottomright",pch=c(15,15),col=c("dodgerblue4","lightsteelblue4"), c("Individual","Composite"),
bty="o",box.col = "black")
plot(mds, type="none", choices=c(1,2), cex.lab=1.5,cex.axis=1.5,font=1.5,font.axis=2,
font.lab=1.5, xlim=c(-0.09,0.12),ylim=c(-0.09,0.09),xlab= "NMDS Axis 1", ylab="NMDS Axis 2",
main = "Comparison of Sample Types Across Sites", frame.plot=FALSE)
points(mds.sc[,1], mds.sc[,2],display="sites", col="black",
pch = (as.integer(env$siteID) + 6), bg=ifelse(env$sampleType=="Individual","dodgerblue4","lightsteelblue2"))
#ordihull(mds, env$siteID, lty=2)
legend("topright",pch=c(seq(7,12)), col="black", c("CPER","DSNY","HARV","OSBS","STER","TALL"),
bty="o",box.col="black", cex=.8)
legend("bottomright",pch=c(15,15),col=c("dodgerblue4","lightsteelblue4"), c("Individual","Composite"),
bty="o",box.col = "black")
plot(mds, type="none", choices=c(1,2), cex.lab=1.5,cex.axis=1.5,font=1.5,font.axis=2,
font.lab=1.5, xlim=c(-0.09,0.12),ylim=c(-0.09,0.09),xlab= "NMDS Axis 1", ylab="NMDS Axis 2",
main = "Comparison of Sample Types Across Sites", frame.plot=FALSE)
points(mds.sc[,1], mds.sc[,2],display="sites", col=ifelse(env$sampleType=="Individual","dodgerblue4","lightsteelblue2"),
pch = (as.integer(env$siteID) + 6), bg=ifelse(env$sampleType=="Individual","dodgerblue4","lightsteelblue2"))
#ordihull(mds, env$siteID, lty=2)
legend("topright",pch=c(seq(7,12)), col="black", c("CPER","DSNY","HARV","OSBS","STER","TALL"),
bty="o",box.col="black", cex=.8)
legend("bottomright",pch=c(15,15),col=c("dodgerblue4","lightsteelblue4"), c("Individual","Composite"),
bty="o",box.col = "black")
plot(mds, type="none", choices=c(1,2), cex.lab=1.5,cex.axis=1.5,font=1.5,font.axis=2,
font.lab=1.5, xlim=c(-0.09,0.12),ylim=c(-0.09,0.09),xlab= "NMDS Axis 1", ylab="NMDS Axis 2",
main = "Comparison of Sample Types Across Sites", frame.plot=FALSE, ylim=0.1)
points(mds.sc[,1], mds.sc[,2],display="sites", col=ifelse(env$sampleType=="Individual","dodgerblue4","lightsteelblue2"),
pch = (as.integer(env$siteID) + 6), bg=ifelse(env$sampleType=="Individual","dodgerblue4","lightsteelblue2"))
#ordihull(mds, env$siteID, lty=2)
legend("topright",pch=c(seq(7,12)), col="black", c("CPER","DSNY","HARV","OSBS","STER","TALL"),
bty="o",box.col="black", cex=.8)
legend("bottomright",pch=c(15,15),col=c("dodgerblue4","lightsteelblue4"), c("Individual","Composite"),
bty="o",box.col = "black")
plot(mds, type="none", choices=c(1,2), cex.lab=1.5,cex.axis=1.5,font=1.5,font.axis=2,
font.lab=1.5, xlim=c(-0.09,0.12),ylim=c(-0.09,0.09),xlab= "NMDS Axis 1", ylab="NMDS Axis 2",
main = "Comparison of Sample Types Across Sites", frame.plot=FALSE, ylim=0.1)
points(mds.sc[,1], mds.sc[,2],display="sites", col=ifelse(env$sampleType=="Individual","dodgerblue4","tan3"),
pch = (as.integer(env$siteID) + 6), bg=ifelse(env$sampleType=="Individual","dodgerblue4","tan3"))
#ordihull(mds, env$siteID, lty=2)
legend("topright",pch=c(seq(7,12)), col="black", c("CPER","DSNY","HARV","OSBS","STER","TALL"),
bty="o",box.col="black", cex=.8)
legend("bottomright",pch=c(15,15),col=c("dodgerblue4","lightsteelblue4"), c("Individual","Composite"),
bty="o",box.col = "black")
plot(mds, type="none", choices=c(1,2), cex.lab=1.5,cex.axis=1.5,font=1.5,font.axis=2,
font.lab=1.5, xlim=c(-0.09,0.12),ylim=c(-0.09,0.09),xlab= "NMDS Axis 1", ylab="NMDS Axis 2",
main = "Comparison of Sample Types Across Sites", frame.plot=FALSE)
points(mds.sc[,1], mds.sc[,2],display="sites", col=ifelse(env$sampleType=="Individual","dodgerblue4","tan3"),
pch = (as.integer(env$siteID) + 6), bg=ifelse(env$sampleType=="Individual","dodgerblue4","tan3"))
#ordihull(mds, env$siteID, lty=2)
legend("topright",pch=c(seq(7,12)), col="black", c("CPER","DSNY","HARV","OSBS","STER","TALL"),
bty="o",box.col="black", cex=.8)
legend("bottomright",pch=c(15,15),col=c("dodgerblue4","lightsteelblue4"), c("Individual","Composite"),
bty="o",box.col = "black")
plot(mds, type="none", choices=c(1,2), cex.lab=1.5,cex.axis=1.5,font=1.5,font.axis=2,
font.lab=1.5, xlim=c(-0.09,0.12),ylim=c(-0.09,0.09),xlab= "NMDS Axis 1", ylab="NMDS Axis 2",
main = "Comparison of Sample Types Across Sites", frame.plot=FALSE)
points(mds.sc[,1], mds.sc[,2],display="sites", col=ifelse(env$sampleType=="Individual","dodgerblue4","tan3"),
pch = (as.integer(env$siteID) + 6), bg=ifelse(env$sampleType=="Individual","dodgerblue4","tan3"))
#ordihull(mds, env$siteID, lty=2)
legend(pch=c(seq(7,12)), col="black", c("CPER","DSNY","HARV","OSBS","STER","TALL"),
bty="o",box.col="black", cex=.8)
legend(pch=c(15,15),col=c("dodgerblue4","tan3"), c("Individual","Composite"),
bty="o",box.col = "black")
legend(0.1,0.05,pch=c(seq(7,12)), col="black", c("CPER","DSNY","HARV","OSBS","STER","TALL"),
bty="o",box.col="black", cex=.8)
legend(0.15,0.0,pch=c(15,15),col=c("dodgerblue4","tan3"), c("Individual","Composite"),
bty="o",box.col = "black")
legend(0.1,0.05,pch=c(seq(7,12)), col="black", c("CPER","DSNY","HARV","OSBS","STER","TALL"),
bty="o",box.col="black", cex=.8)
legend(0.1,0.0,pch=c(15,15),col=c("dodgerblue4","tan3"), c("Individual","Composite"),
bty="o",box.col = "black")
plot(mds, type="none", choices=c(1,2), cex.lab=1.5,cex.axis=1.5,font=1.5,font.axis=2,
font.lab=1.5, xlim=c(-0.09,0.12),ylim=c(-0.09,0.09),xlab= "NMDS Axis 1", ylab="NMDS Axis 2",
main = "Functional Potential Across Sites by Sample Type", frame.plot=FALSE)
points(mds.sc[,1], mds.sc[,2],display="sites", col=ifelse(env$sampleType=="Individual","dodgerblue4","tan3"),
pch = (as.integer(env$siteID) + 6), bg=ifelse(env$sampleType=="Individual","dodgerblue4","tan3"))
#ordihull(mds, env$siteID, lty=2)
legend(0.1,0.05,pch=c(seq(7,12)), col="black", c("CPER","DSNY","HARV","OSBS","STER","TALL"),
bty="o",box.col="black", cex=.8)
legend(0.1,0.0,pch=c(15,15),col=c("dodgerblue4","tan3"), c("Individual","Composite"),
bty="o",box.col = "black")
ordihull(mds, env$siteID, lty=2)
ordihull(mds, env$siteID, lty=2, draw="polygon",
col=c("turquoise", "turquoise1","turquoise2","mediumturquoise","turquoise3","turquoise4"))
plot(mds, type="none", choices=c(1,2), cex.lab=1.5,cex.axis=1.5,font=1.5,font.axis=2,
font.lab=1.5, xlim=c(-0.09,0.12),ylim=c(-0.09,0.09),xlab= "NMDS Axis 1", ylab="NMDS Axis 2",
main = "Functional Potential Across Sites by Sample Type", frame.plot=FALSE)
points(mds.sc[,1], mds.sc[,2],display="sites", col=ifelse(env$sampleType=="Individual","dodgerblue4","tan3"),
pch = (as.integer(env$siteID) + 6), bg=ifelse(env$sampleType=="Individual","dodgerblue4","tan3"))
ordihull(mds, env$siteID, lty=2, draw="polygon",
col=c("turquoise", "turquoise1","turquoise2","mediumturquoise","turquoise3","turquoise4"), alpha=5)
legend(0.1,0.05,pch=c(seq(7,12)), col="black", c("CPER","DSNY","HARV","OSBS","STER","TALL"),
bty="o",box.col="black", cex=.8)
legend(0.1,0.0,pch=c(15,15),col=c("dodgerblue4","tan3"), c("Individual","Composite"),
bty="o",box.col = "black")
ordihull(mds, env$siteID, lty=2, draw="polygon",
col=c("turquoise", "turquoise1","turquoise2","mediumturquoise","turquoise3","turquoise4"), alpha=50)
ordihull(mds, env$siteID, lty=2, draw="lines",
col=c("turquoise", "turquoise1","turquoise2","mediumturquoise","turquoise3","turquoise4"))
plot(mds, type="none", choices=c(1,2), cex.lab=1.5,cex.axis=1.5,font=1.5,font.axis=2,
font.lab=1.5, xlim=c(-0.09,0.12),ylim=c(-0.09,0.09),xlab= "NMDS Axis 1", ylab="NMDS Axis 2",
main = "Functional Potential Across Sites by Sample Type", frame.plot=FALSE)
points(mds.sc[,1], mds.sc[,2],display="sites", col=ifelse(env$sampleType=="Individual","dodgerblue4","tan3"),
pch = (as.integer(env$siteID) + 6), bg=ifelse(env$sampleType=="Individual","dodgerblue4","tan3"))
ordihull(mds, env$siteID, lty=2, draw="lines",
col=c("turquoise", "turquoise1","turquoise2","mediumturquoise","turquoise3","turquoise4"))
legend(0.1,0.05,pch=c(seq(7,12)), col="black", c("CPER","DSNY","HARV","OSBS","STER","TALL"),
bty="o",box.col="black", cex=.8)
legend(0.1,0.0,pch=c(15,15),col=c("dodgerblue4","tan3"), c("Individual","Composite"),
bty="o",box.col = "black")
plot(mds, type="none", choices=c(1,2), cex.lab=1.5,cex.axis=1.5,font=1.5,font.axis=2,
font.lab=1.5, xlim=c(-0.09,0.12),ylim=c(-0.09,0.09),xlab= "NMDS Axis 1", ylab="NMDS Axis 2",
main = "Functional Potential Across Sites by Sample Type", frame.plot=FALSE)
points(mds.sc[,1], mds.sc[,2],display="sites", col=ifelse(env$sampleType=="Individual","dodgerblue4","tan3"),
pch = (as.integer(env$siteID) + 6), bg=ifelse(env$sampleType=="Individual","dodgerblue4","tan3"))
ordihull(mds, env$siteID, lty=2, draw="lines",
col=c("darkolivegreen4", "snow3","orchid4","tomato","goldenrod1","darkred"))
legend(0.1,0.05,pch=c(seq(7,12)), col="black", c("CPER","DSNY","HARV","OSBS","STER","TALL"),
bty="o",box.col="black", cex=.8)
legend(0.1,0.0,pch=c(15,15),col=c("dodgerblue4","tan3"), c("Individual","Composite"),
bty="o",box.col = "black")
plot(mds, type="none", choices=c(1,2), cex.lab=1.5,cex.axis=1.5,font=1.5,font.axis=2,
font.lab=1.5, xlim=c(-0.09,0.12),ylim=c(-0.09,0.09),xlab= "NMDS Axis 1", ylab="NMDS Axis 2",
main = "Functional Potential Across Sites by Sample Type", frame.plot=FALSE)
points(mds.sc[,1], mds.sc[,2],display="sites", col=ifelse(env$sampleType=="Individual","dodgerblue4","tan3"),
pch = (as.integer(env$siteID) + 6), bg=ifelse(env$sampleType=="Individual","dodgerblue4","tan3"))
ordihull(mds, env$siteID, lty=2, draw="lines", col=hues)
legend(0.1,0.05,pch=c(seq(7,12)), col="black", c("CPER","DSNY","HARV","OSBS","STER","TALL"),
bty="o",box.col="black", cex=.8)
legend(0.1,0.0,pch=c(15,15),col=c("dodgerblue4","tan3"), c("Individual","Composite"),
bty="o",box.col = "black")
hues <- c("darkolivegreen4", "snow3","orchid4","tomato","goldenrod1","darkred")
ordihull(mds, env$siteID, lty=2, draw="lines", col=hues)
points(mdsfn5000[,1], mdsfn5000[,2], display="sites", col="black", pch=19)
functionMax <- apply(otu.1,2,max)
#hist(functionMax, breaks=24)
mdsfn5000 <- mds$species[functionMax>20000,]   ##nMDS functional coordinates for OTUs
mdsfn5000IDs <- rownames(mdsfn5000)
points(mdsfn5000[,1], mdsfn5000[,2], display="sites", col="gray28", pch=20)
text(mdsfn5000[,1], mdsfn5000[,2], display="sites", col="black", labels=seq(1,20), cex=0.5)
plot(mds, type="none", choices=c(1,2), cex.lab=1.5,cex.axis=1.5,font=1.5,font.axis=2,
font.lab=1.5, xlim=c(-0.09,0.12),ylim=c(-0.09,0.09),xlab= "NMDS Axis 1", ylab="NMDS Axis 2",
main = "Functional Potential Across Sites by Sample Type", frame.plot=FALSE)
points(mds.sc[,1], mds.sc[,2],display="sites", col=ifelse(env$sampleType=="Individual","dodgerblue4","tan3"),
pch = (as.integer(env$siteID) + 6), bg=ifelse(env$sampleType=="Individual","dodgerblue4","tan3"))
#ordihull(mds, env$siteID, lty=2, draw="lines", col="black")
legend(0.1,0.05,pch=c(seq(7,12)), col="black", c("CPER","DSNY","HARV","OSBS","STER","TALL"),
bty="o",box.col="black", cex=.8)
legend(0.1,0.0,pch=c(15,15),col=c("dodgerblue4","tan3"), c("Individual","Composite"),
bty="o",box.col = "black")
points(mdsfn5000[,1], mdsfn5000[,2], display="sites", col="lightcyan2", pch=20)
text(mdsfn5000[,1], mdsfn5000[,2], display="sites", col="black", labels=seq(1,20), cex=0.5)
points(mdsfn5000[,1], mdsfn5000[,2], display="sites", col="darkgreen", pch=20)
text(mdsfn5000[,1], mdsfn5000[,2], display="sites", col="black", labels=seq(1,20), cex=5)
points(mdsfn5000[,1], mdsfn5000[,2], display="sites", col="darkgreen", pch=20)
text(mdsfn5000[,1], mdsfn5000[,2], display="sites", col="black", labels=seq(1,20), cex=1)
plot(mds, type="none", choices=c(1,2), cex.lab=1.5,cex.axis=1.5,font=1.5,font.axis=2,
font.lab=1.5, xlim=c(-0.09,0.12),ylim=c(-0.09,0.09),xlab= "NMDS Axis 1", ylab="NMDS Axis 2",
main = "Functional Potential Across Sites by Sample Type", frame.plot=FALSE)
points(mds.sc[,1], mds.sc[,2],display="sites", col=ifelse(env$sampleType=="Individual","dodgerblue4","tan3"),
pch = (as.integer(env$siteID) + 6), bg=ifelse(env$sampleType=="Individual","dodgerblue4","tan3"))
#ordihull(mds, env$siteID, lty=2, draw="lines", col="black")
legend(0.1,0.05,pch=c(seq(7,12)), col="black", c("CPER","DSNY","HARV","OSBS","STER","TALL"),
bty="o",box.col="black", cex=.8)
legend(0.1,0.0,pch=c(15,15),col=c("dodgerblue4","tan3"), c("Individual","Composite"),
bty="o",box.col = "black")
points(mdsfn5000[,1], mdsfn5000[,2], display="sites", col="darkgreen", pch=20)
text(mdsfn5000[,1], mdsfn5000[,2], display="sites", col="black", labels=seq(1,20), cex=1)
plot(mds, type="none", choices=c(1,2), cex.lab=1.5,cex.axis=1.5,font=1.5,font.axis=2,
font.lab=1.5, xlim=c(-0.09,0.12),ylim=c(-0.09,0.09),xlab= "NMDS Axis 1", ylab="NMDS Axis 2",
main = "Functional Potential Across Sites by Sample Type", frame.plot=FALSE)
points(mds.sc[,1], mds.sc[,2],display="sites", col=ifelse(env$sampleType=="Individual","dodgerblue4","tan3"),
pch = (as.integer(env$siteID) + 6), bg=ifelse(env$sampleType=="Individual","dodgerblue4","tan3"))
#ordihull(mds, env$siteID, lty=2, draw="lines", col="black")
legend(0.1,0.05,pch=c(seq(7,12)), col="black", c("CPER","DSNY","HARV","OSBS","STER","TALL"),
bty="o",box.col="black", cex=.8)
legend(0.1,0.0,pch=c(15,15),col=c("dodgerblue4","tan3"), c("Individual","Composite"),
bty="o",box.col = "black")
points(mdsfn5000[,1], mdsfn5000[,2], display="sites", col="darkgreen", pch=20)
text(mdsfn5000[,1], mdsfn5000[,2], display="sites", col="black", labels=seq(1,20), cex=0.75, pos=3)
plot(mds, type="none", choices=c(1,2), cex.lab=1.5,cex.axis=1.5,font=1.5,font.axis=2,
font.lab=1.5, xlim=c(-0.09,0.12),ylim=c(-0.09,0.09),xlab= "NMDS Axis 1", ylab="NMDS Axis 2",
main = "Functional Potential Across Sites by Sample Type", frame.plot=FALSE)
points(mds.sc[,1], mds.sc[,2],display="sites", col=ifelse(env$sampleType=="Individual","dodgerblue4","tan3"),
pch = (as.integer(env$siteID) + 6), bg=ifelse(env$sampleType=="Individual","dodgerblue4","tan3"))
#ordihull(mds, env$siteID, lty=2, draw="lines", col="black")
legend(0.1,0.05,pch=c(seq(7,12)), col="black", c("CPER","DSNY","HARV","OSBS","STER","TALL"),
bty="o",box.col="black", cex=.8)
legend(0.1,0.0,pch=c(15,15),col=c("dodgerblue4","tan3"), c("Individual","Composite"),
bty="o",box.col = "black")
points(mdsfn5000[,1], mdsfn5000[,2], display="sites", col="firebrick", pch=20)
text(mdsfn5000[,1], mdsfn5000[,2], display="sites", col="black", labels=seq(1,20), cex=0.75, pos=1)
plot(mds, type="none", choices=c(1,2), cex.lab=1.5,cex.axis=1.5,font=1.5,font.axis=2,
font.lab=1.5, xlim=c(-0.09,0.12),ylim=c(-0.09,0.09),xlab= "NMDS Axis 1", ylab="NMDS Axis 2",
main = "Functional Potential Across Sites by Sample Type", frame.plot=FALSE)
points(mds.sc[,1], mds.sc[,2],display="sites", col=ifelse(env$sampleType=="Individual","dodgerblue4","tan3"),
pch = (as.integer(env$siteID) + 6), bg=ifelse(env$sampleType=="Individual","dodgerblue4","tan3"))
#ordihull(mds, env$siteID, lty=2, draw="lines", col="black")
legend(0.1,0.05,pch=c(seq(7,12)), col="black", c("CPER","DSNY","HARV","OSBS","STER","TALL"),
bty="o",box.col="black", cex=.8)
legend(0.1,0.0,pch=c(15,15),col=c("dodgerblue4","tan3"), c("Individual","Composite"),
bty="o",box.col = "black")
points(mdsfn5000[,1], mdsfn5000[,2], display="sites", col="firebrick", pch=4)
text(mdsfn5000[,1], mdsfn5000[,2], display="sites", col="black", labels=seq(1,20), cex=0.75, pos=1)
plot(mds, type="none", choices=c(1,2), cex.lab=1.5,cex.axis=1.5,font=1.5,font.axis=2,
font.lab=1.5, xlim=c(-0.09,0.12),ylim=c(-0.09,0.09),xlab= "NMDS Axis 1", ylab="NMDS Axis 2",
main = "Functional Potential Across Sites by Sample Type", frame.plot=FALSE)
points(mds.sc[,1], mds.sc[,2],display="sites", col=ifelse(env$sampleType=="Individual","dodgerblue4","tan3"),
pch = (as.integer(env$siteID) + 6), bg=ifelse(env$sampleType=="Individual","dodgerblue4","tan3"))
#ordihull(mds, env$siteID, lty=2, draw="lines", col="black")
legend(0.1,0.05,pch=c(seq(7,12)), col="black", c("CPER","DSNY","HARV","OSBS","STER","TALL"),
bty="o",box.col="black", cex=.8)
legend(0.1,0.0,pch=c(15,15),col=c("dodgerblue4","tan3"), c("Individual","Composite"),
bty="o",box.col = "black")
######## Select more abundant functions to plot ######
functionMax <- apply(otu.1,2,max)
#hist(functionMax, breaks=24)
mdsfn5000 <- mds$species[functionMax>20000,]   ##nMDS functional coordinates for OTUs
mdsfn5000IDs <- rownames(mdsfn5000)
points(mdsfn5000[,1], mdsfn5000[,2], display="sites", col="black", pch=4)
text(mdsfn5000[,1], mdsfn5000[,2], display="sites", col="black", labels=seq(1,20), cex=0.75, pos=1)
plot(mds, type="none", choices=c(1,2), cex.lab=1.5,cex.axis=1.5,font=1.5,font.axis=2,
font.lab=1.5, xlim=c(-0.09,0.12),ylim=c(-0.09,0.09),xlab= "NMDS Axis 1", ylab="NMDS Axis 2",
main = "Functional Potential Across Sites by Sample Type", frame.plot=FALSE)
#points(mds.sc[,1], mds.sc[,2],display="sites", col=ifelse(env$sampleType=="Individual","dodgerblue4","tan3"),
pch = (as.integer(env$siteID) + 6), bg=ifelse(env$sampleType=="Individual","dodgerblue4","tan3"))
ordihull(mds, env$siteID, lty=2, draw="lines", col="black")
legend(0.1,0.05,pch=c(seq(7,12)), col="black", c("CPER","DSNY","HARV","OSBS","STER","TALL"),
bty="o",box.col="black", cex=.8)
legend(0.1,0.0,pch=c(15,15),col=c("dodgerblue4","tan3"), c("Individual","Composite"),
bty="o",box.col = "black")
points(mdsfn5000[,1], mdsfn5000[,2], display="sites", col="black", pch=4)
text(mdsfn5000[,1], mdsfn5000[,2], display="sites", col="black", labels=seq(1,20), cex=0.75, pos=1)
points(mdsfn5000[,1], mdsfn5000[,2], display="sites", col="firebrick", pch=4)
mdsfn5000 <- mds$species[functionMax>10000,]   ##nMDS functional coordinates for OTUs
mdsfn5000IDs <- rownames(mdsfn5000)
points(mdsfn5000[,1], mdsfn5000[,2], display="sites", col="firebrick", pch=4)
text(mdsfn5000[,1], mdsfn5000[,2], display="sites", col="black", labels=seq(1,20), cex=0.75, pos=1)
plot(mds, type="none", choices=c(1,2), cex.lab=1.5,cex.axis=1.5,font=1.5,font.axis=2,
font.lab=1.5, xlim=c(-0.09,0.12),ylim=c(-0.09,0.09),xlab= "NMDS Axis 1", ylab="NMDS Axis 2",
main = "Functional Potential Across Sites by Sample Type", frame.plot=FALSE)
points(mds.sc[,1], mds.sc[,2],display="sites", col=ifelse(env$sampleType=="Individual","dodgerblue4","tan3"),
pch = (as.integer(env$siteID) + 6), bg=ifelse(env$sampleType=="Individual","dodgerblue4","tan3"))
#ordihull(mds, env$siteID, lty=2, draw="lines", col="black")
legend(0.1,0.05,pch=c(seq(7,12)), col="black", c("CPER","DSNY","HARV","OSBS","STER","TALL"),
bty="o",box.col="black", cex=.8)
legend(0.1,0.0,pch=c(15,15),col=c("dodgerblue4","tan3"), c("Individual","Composite"),
bty="o",box.col = "black")
plot(mds, type="none", choices=c(1,2), cex.lab=1.5,cex.axis=1.5,font=1.5,font.axis=2,
font.lab=1.5, xlim=c(-0.09,0.12),ylim=c(-0.09,0.09),xlab= "NMDS Axis 1", ylab="NMDS Axis 2",
main = "Functional Potential Across Sites by Sample Type", frame.plot=FALSE)
points(mds.sc[,1], mds.sc[,2],display="sites", col=ifelse(env$sampleType=="Individual","dodgerblue4","tan3"),
pch = (as.integer(env$siteID) + 6), bg=ifelse(env$sampleType=="Individual","dodgerblue4","tan3"))
#ordihull(mds, env$siteID, lty=2, draw="lines", col="black")
legend(0.1,0.05,pch=c(seq(7,12)), col="black", c("CPER","DSNY","HARV","OSBS","STER","TALL"),
bty="o",box.col="black", cex=.8)
legend(0.1,0.0,pch=c(15,15),col=c("dodgerblue4","tan3"), c("Individual","Composite"),
bty="o",box.col = "black")
######## Select more abundant functions to plot ######
functionMax <- apply(otu.1,2,max)
#hist(functionMax, breaks=24)
mdsfn5000 <- mds$species[functionMax>20000,]   ##nMDS functional coordinates for OTUs
mdsfn5000IDs <- rownames(mdsfn5000)
points(mdsfn5000[,1], mdsfn5000[,2], display="sites", col="firebrick", pch=4)
text(mdsfn5000[,1], mdsfn5000[,2], display="sites", col="black", labels=seq(1,20), cex=0.75, pos=1)
plot(mds, type="none", choices=c(1,2), cex.lab=1.5,cex.axis=1.5,font=1.5,font.axis=2,
font.lab=1.5, xlim=c(-0.09,0.12),ylim=c(-0.09,0.09),xlab= "NMDS Axis 1", ylab="NMDS Axis 2",
main = "Functional Potential Across Sites by Sample Type", frame.plot=FALSE)
points(mds.sc[,1], mds.sc[,2],display="sites", col=ifelse(env$sampleType=="Individual","dodgerblue4","tan3"),
pch = (as.integer(env$siteID) + 6), bg=ifelse(env$sampleType=="Individual","dodgerblue4","tan3"))
#ordihull(mds, env$siteID, lty=2, draw="lines", col="black")
legend(0.1,0.05,pch=c(seq(7,12)), col="black", c("CPER","DSNY","HARV","OSBS","STER","TALL"),
bty="o",box.col="black", cex=.8)
legend(0.1,0.0,pch=c(15,15,4),col=c("dodgerblue4","tan3","firebrick"), c("Individual","Composite","Function"),
bty="o",box.col = "black")
######## Select more abundant functions to plot ######
functionMax <- apply(otu.1,2,max)
#hist(functionMax, breaks=24)
mdsfn5000 <- mds$species[functionMax>20000,]   ##nMDS functional coordinates for OTUs
mdsfn5000IDs <- rownames(mdsfn5000)
points(mdsfn5000[,1], mdsfn5000[,2], display="sites", col="firebrick", pch=4)
text(mdsfn5000[,1], mdsfn5000[,2], display="sites", col="black", labels=seq(1,20), cex=0.75, pos=1)
plot(mds, type="none", choices=c(1,2), cex.lab=1.5,cex.axis=1.5,font=1.5,font.axis=2,
font.lab=1.5, xlim=c(-0.09,0.12),ylim=c(-0.09,0.09),xlab= "NMDS Axis 1", ylab="NMDS Axis 2",
main = "Functional Potential Across Sites by Sample Type", frame.plot=FALSE)
points(mds.sc[,1], mds.sc[,2],display="sites", col=ifelse(env$sampleType=="Individual","dodgerblue4","tan3"),
pch = (as.integer(env$siteID) + 6), bg=ifelse(env$sampleType=="Individual","dodgerblue4","tan3"))
#ordihull(mds, env$siteID, lty=2, draw="lines", col="black")
legend(0.1,0.05,pch=c(seq(7,12)), col="black", c("CPER","DSNY","HARV","OSBS","STER","TALL"),
bty="o",box.col="black", cex=.8)
legend(0.1,0.0,pch=c(15,15,4),col=c("dodgerblue4","tan3","black"), c("Individual","Composite","Function"),
bty="o",box.col = "black")
######## Select more abundant functions to plot ######
functionMax <- apply(otu.1,2,max)
#hist(functionMax, breaks=24)
mdsfn5000 <- mds$species[functionMax>20000,]   ##nMDS functional coordinates for OTUs
mdsfn5000IDs <- rownames(mdsfn5000)
points(mdsfn5000[,1], mdsfn5000[,2], display="sites", col="black", pch=4)
text(mdsfn5000[,1], mdsfn5000[,2], display="sites", col="black", labels=seq(1,20), cex=0.75, pos=1)
plot(mds, type="none", choices=c(1,2), cex.lab=1.5,cex.axis=1.5,font=1.5,font.axis=2,
font.lab=1.5, xlim=c(-0.09,0.12),ylim=c(-0.09,0.09),xlab= "NMDS Axis 1", ylab="NMDS Axis 2",
main = "Functional Potential Across Sites by Sample Type", frame.plot=FALSE)
ordihull(mds, env$siteID, lty=2, draw="lines", col="mistyrose4")
points(mdsfn5000[,1], mdsfn5000[,2], display="sites", col="black", pch=4)
text(mdsfn5000[,1], mdsfn5000[,2], display="sites", col="black", labels=seq(1,20), cex=0.75, pos=1)
plot(mds, type="none", choices=c(1,2), cex.lab=1.5,cex.axis=1.5,font=1.5,font.axis=2,
font.lab=1.5, xlim=c(-0.09,0.12),ylim=c(-0.09,0.09),xlab= "NMDS Axis 1", ylab="NMDS Axis 2",
main = "Functional Potential Across Sites by Sample Type", frame.plot=FALSE)
points(mds.sc[,1], mds.sc[,2],display="sites", col=ifelse(env$sampleType=="Individual","dodgerblue4","tan3"),
pch = (as.integer(env$siteID) + 6), bg=ifelse(env$sampleType=="Individual","dodgerblue4","tan3"))
ordispider(mds, env$siteID, lty=2, draw="lines", col="mistyrose4")
ordispider(mds, env$siteID, lty=2, draw="lines", col="black")
points(mdsfn5000[,1], mdsfn5000[,2], display="sites", col="firebrick", pch=4)
text(mdsfn5000[,1], mdsfn5000[,2], display="sites", col="black", labels=seq(1,20), cex=0.75, pos=1)
points(mdsfn5000[,1], mdsfn5000[,2], display="sites", col="firebrick1", pch=4)
points(mdsfn5000[,1], mdsfn5000[,2], display="sites", col="red3", pch=4)
points(mdsfn5000[,1], mdsfn5000[,2], display="sites", col="maroon4", pch=4)
points(mdsfn5000[,1], mdsfn5000[,2], display="sites", col="maroon2", pch=4)
legend(0.1,0.05,pch=c(seq(7,12)), col="black", c("CPER","DSNY","HARV","OSBS","STER","TALL"),
bty="o",box.col="black", cex=.8)
legend(0.1,0.0,pch=c(15,15,4),col=c("dodgerblue4","tan3","maroon2"), c("Individual","Composite","Functions"),
bty="o",box.col = "black"
)
plot(mds, type="none", choices=c(1,2), cex.lab=1.5,cex.axis=1.5,font=1.5,font.axis=2,
font.lab=1.5, xlim=c(-0.09,0.12),ylim=c(-0.09,0.09),xlab= "NMDS Axis 1", ylab="NMDS Axis 2",
main = "Functional Potential Across Sites by Sample Type", frame.plot=FALSE)
ordispider(mds, env$siteID, lty=2, draw="lines", col="black")
points(mdsfn5000[,1], mdsfn5000[,2], display="sites", col="maroon2", pch=4)
text(mdsfn5000[,1], mdsfn5000[,2], display="sites", col="black", labels=seq(1,20), cex=0.75, pos=1)
rm(list=ls())
